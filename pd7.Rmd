---
title: "Práctica dirigida 7"
output:
  html_document:
    toc: yes
    toc_float: yes
    collapsed: no
    number_sections: no
    toc_depth: 3
    theme: flatly
    highlight: textmate
    always_allow_html: yes
editor_options: 
  markdown: 
    wrap: 72
---

**FACULTAD DE CIENCIAS SOCIALES - PUCP**

Curso: SOC294 - Estadística para el análisis sociológico 1

Semestre 2024 - 2

# Repaso

```{r, warning=FALSE,message=FALSE}
library(rio)
library(dplyr)
library(ggplot2)
library(lsr)
```

```{r}
data = import("Data-provincias.xlsx")
```

## Prueba T

¿Existe alguna diferencia en el promedio del voto (%) por Keiko Fujimori (FP) en segunda vuelta según el nivel de IDH (alto/bajo)?

```{r}
tabla1 = data %>% 
  group_by(IDH_cat) %>% 
  summarise(Media = mean(FP, na.rm=T),
            LimSup = ciMean(FP, na.rm=T)[1],
            LimInf = ciMean(FP, na.rm=T)[2])

tabla1
```

```{r}
ggplot(tabla1, aes(x=IDH_cat, y=Media))+
  geom_errorbar(aes(ymin = LimInf, ymax= LimSup),width=0.3)+
  theme_light()+
  xlab("Nivel de IDH")+ylab("% de voto a Keiko Fujimori")
```

```{r}
t.test(data$FP ~ data$IDH_cat)
```

## Anova 

```{r}
tabla2 = data %>% 
  group_by(Reg_nat) %>% 
  summarise(Media = mean(FP, na.rm=T),
            LimSup = ciMean(FP, na.rm=T)[1],
            LimInf = ciMean(FP, na.rm=T)[2])

tabla2
```

```{r}
ggplot(tabla2, aes(x=Reg_nat, y=Media))+
  geom_errorbar(aes(ymin = LimInf, ymax= LimSup),width=0.3)+
  theme_light()+
  xlab("Región natural")+ylab("% de voto a Keiko Fujimori")
```
```{r}
anova=aov(data$FP~data$Reg_nat)
summary(anova)
```

## Chi cuadrado

¿Existe alguna diferencia en el voto (%) por Keiko Fujimori (FP) (en segunda vuelta según si es de la sierra o no (Sierra_no)?

```{r}
tabla3 = table(data$FP_cat,data$Años_educ)
tabla3
```
```{r}
prop= as.data.frame(prop.table(tabla2,2))
prop
```
```{r}
names(prop)=c("Voto","Años_educ","Porcentaje")
```

```{r}
ggplot(prop, aes(x=Años_educ,y=Porcentaje*100, fill=Voto))+
  geom_bar(stat="identity", position="stack")+
  geom_text(aes(label=paste(round(Porcentaje*100,1),"%")),
  position = position_stack(vjust = 0.5))+
  ylab("Porcentaje(%)")+xlab("Años de educación")+
  theme_minimal()
```

```{r}
chisq.test(tabla3)$expected
```
```{r}
chisq.test(tabla3)
```
## Correlación

```{r}
ggplot(data, aes(x=FP, y=ingresos))+
  geom_point()+
  geom_smooth(method="lm")+
  xlab("Voto por Keiko Fujimori (%)")+
  theme_minimal()
```

```{r}
cor.test(data$FP,data$ingresos)
```

