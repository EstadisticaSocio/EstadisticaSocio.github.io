---
title: "Pr치ctica dirigida 2"
output:
  html_document:
    toc: yes
    toc_float: yes
    collapsed: no
    number_sections: no
    toc_depth: 3
    theme: flatly
    highlight: textmate
    always_allow_html: yes
---

**FACULTAD DE CIENCIAS SOCIALES - PUCP**

Curso: SOC294 - Estad칤stica para el an치lisis sociol칩gico 1

Semestre 2024 - 2

# **1.쯈u칠 es el an치lisis descriptivo?**

```{r,echo=FALSE, out.width="80%",fig.align="center"}
knitr::include_graphics("pd2_QSAnalisisDesc.png") 
```

# **2.Nivel de medida de una variable**

```{r,echo=FALSE, out.width="50%",fig.align="center"}
knitr::include_graphics("pd2_medVar.png") 
```

# **3.Importancia de visualizaci칩n de datos**

Debido al crecimiento de la big data en los 칰ltimos a침os surgieron nuevas necesidades para comprender los an치lisis masivos de datos de una forma simple y escalable. Es entonces cuando se dirige la atenci칩n a desarrollar nuevas t칠cnicas gr치ficas en distintas plataformas (ejemplos a continuaci칩n), tanto softwares como librer칤as de c칩digo abierto[^1], tal es el caso de ggplot2 en R.

[^1]: <https://www.data-to-viz.com/caveat/pie.html>

```{r,echo=FALSE, out.width="90%",fig.align="center"}
knitr::include_graphics("pd2_herramientas.png") 
```

Este inter칠s por desarrollar t칠cnicas de an치lisis masivo de datos y la comunicaci칩n de resultados cada vez m치s amigables y apta para todos los p칰blicos dio pie a nuevas especialidades dentro de la ciencia de datos, como por ejemplo el data story telling

```{r,echo=FALSE, out.width="90%",fig.align="center"}
knitr::include_graphics("pd2_datavis.png") 
```

### **Gr치ficos por tipo de variables:**

```{r,echo=FALSE, out.width="60%",fig.align="center"}
knitr::include_graphics("pd2_GrafTipoVar.png") 
```

# **4.An치lisis descriptivo**

```{=html}
<style>
.custom-text {
  color: #00688B;
  font-family: Helvetica, sans-serif;
  text-align: center;
  font-weight: bold;
  font-size: 22px;
}
</style>
```
::: custom-text
::: custom-text
쮺u치l es la distribuci칩n y din치mica de las manifestaciones sociales en el Per칰? 游뱂
:::
:::

Para la sesi칩n de hoy se usar치 la **"Base de eventos de protesta (1980 - 2023)",** agregada a nivel regional. Esta fue inicialmente creada por Mois칠s Arce, profesor de la Universidad de Tulane, y recientemente actualizada por la Escuela de Gobierno y Pol칤ticas P칰blicas de la PUCP. Esta base es un aporte para estudiar y comprender mejor la din치mica de la conflictividad popular en el Per칰 desde 1980 hasta la actualidad. Encuentra m치s informaci칩n y la base de datos original en el siguiente [link](https://democracia-gobernabilidad.pucp.edu.pe/participaci%C3%B3n/protestas-sociales).

```{r,message=FALSE,warning=FALSE}
library(rio)
data = import("pd2_Protestas.xlsx")
```

Agregar diccionario

```{r,echo=FALSE, out.width="100%",fig.align="center"}
knitr::include_graphics("pd2_diccionario.png") 
```

## 4.1 쮺칩mo se distribuye (%) las protestas en el Per칰 a nivel regional?

Abrimos la librer칤a dplyr

```{r, warning=FALSE,message=FALSE}
library(dplyr)
```

Comprobamos el tipo de variable que queremos utilizar

```{r}
class(data$Regi칩n)
```

Creamos un summarise donde se encuentre la regi칩n y su frecuencia

```{r}
data %>% 
  group_by(Regi칩n) %>% 
  summarise(Total = sum(Total))
```

Es posible crear una table que incluya tanto frecuencias como porcentajes a침adiendo una l칤nea al comando anterior. Adem치s, para poder representar los resultados en un gr치fico, necesitamos guardar esta tabla en un objeto. Usemos esta tabla resumida y asign칠mosle el nombre gr치fico1, de manera que podamos referirnos a ella cuando creemos el gr치fico

```{r}
gr치fico1 <- data %>% 
  group_by(Regi칩n) %>% 
  summarise(Total = sum(Total)) %>% 
  mutate(Porcentaje = (Total / sum(Total))*100)

gr치fico1
```

Un breve ejemplo. Podemos realizar la misma situaci칩n, inclusive, filtrando. En este caso, nos quedamos solamente con aquellas regiones que tienen por sector com칰n a la ciudadan칤a. Podemos filtrar de distintas maneras.

```{r}
data %>% filter(Sector_comun=="Ciudadan칤a") %>% 
  group_by(Regi칩n) %>% 
  summarise(Total = sum(Total)) %>% 
  mutate(Porcentaje = (Total / sum(Total))*100)
```

Graficamos "gr치fico1" con todas las regiones del Per칰

```{r}
library(ggplot2)

ggplot(gr치fico1, aes(x=Regi칩n, y=Porcentaje, fill=Regi칩n)) + 
  geom_bar(stat = "identity") 
```

El gr치fico anterior, sin embargo, posee demasiada informaci칩n, por lo cual es dif칤cil de observar con claridad. Por lo cual, nos quedaremos solamente con las 5 regiones con mayores porcentajes de protestas sociales, llam치ndolo "gr치fico2"

```{r}
gr치fico2 <- data %>%
  group_by(Regi칩n) %>% 
  summarise(Total = sum(Total)) %>% 
  mutate(Porcentaje = (Total / sum(Total))*100) %>%
  arrange(desc(Porcentaje)) %>%   
  top_n(5, Porcentaje)

gr치fico2
```

Graficamos con las nuevas modificaciones a침adidas

```{r}
ggplot(gr치fico2, aes(x=Regi칩n, y=Porcentaje, fill=Regi칩n)) + 
  geom_bar(stat = "identity")
```

Podemos personalizar nuestros gr치ficos de la manera que deseemos.

```{r}
library(tayloRswift)

ggplot(gr치fico2, aes(x=Regi칩n, y=Porcentaje, fill=Regi칩n)) + 
  geom_bar(stat = "identity")  +
  ggtitle("Las 5 provincias del Per칰 con mayor porcentaje de protestas") +
  xlab("Regi칩n") + ylab("Porcentaje")+
  geom_text(aes(label=round(Porcentaje,1)), vjust=1.3, color="black", size=3)+
  theme(panel.background=element_rect(fill = "white", colour = "white")) +
  scale_fill_taylor(palette = "taylor1989") #fearless, speakNow, Red
```
